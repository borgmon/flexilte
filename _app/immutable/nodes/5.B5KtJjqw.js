import{s as J,e as v,c as w,a as C,d as m,b as $,i as b,q as le,Q as ue,j as P,k as M,g as S,n as D,l as U,p as pe,F as K,t as _e,f as ve,o as Q,h as we,m as de}from"../chunks/scheduler.Bh67o3Vo.js";import{S as V,i as R,c as k,a as E,m as N,t as y,b as B,d as O,g as be,e as ye}from"../chunks/index.BnhmfNAO.js";import{e as q,J as G}from"../chunks/JsonLayout.CaLegjzp.js";import{S as me,c as he,a as F,b as T,t as Z,d as ge,s as W,I as Ce,A as Be}from"../chunks/editorStore.C3nwQ-xd.js";import{a as Se,T as De}from"../chunks/ButtonBox.C_K9paKY.js";import{I as Ae}from"../chunks/Icon.GYccF4GM.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.2hqD1lOb.js";function re(l,e,o){const n=l.slice();return n[3]=e[o],n}function ie(l){let e,o,n,t;return o=new Se({props:{icon:l[3].icon,body:l[3].name,style:"variant-filled-surface text-center"}}),{c(){e=v("div"),k(o.$$.fragment),n=P(),this.h()},l(r){e=w(r,"DIV",{class:!0});var s=C(e);E(o.$$.fragment,s),n=M(s),s.forEach(m),this.h()},h(){$(e,"class","max-h-24 w-32")},m(r,s){b(r,e,s),N(o,e,null),S(e,n),t=!0},p:D,i(r){t||(y(o.$$.fragment,r),t=!0)},o(r){B(o.$$.fragment,r),t=!1},d(r){r&&m(e),O(o)}}}function Ie(l){let e,o,n=q(l[0]),t=[];for(let s=0;s<n.length;s+=1)t[s]=ie(re(l,n,s));const r=s=>B(t[s],1,1,()=>{t[s]=null});return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=le()},l(s){for(let i=0;i<t.length;i+=1)t[i].l(s);e=le()},m(s,i){for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(s,i);b(s,e,i),o=!0},p(s,i){if(i&1){n=q(s[0]);let a;for(a=0;a<n.length;a+=1){const p=re(s,n,a);t[a]?(t[a].p(p,i),y(t[a],1)):(t[a]=ie(p),t[a].c(),y(t[a],1),t[a].m(e.parentNode,e))}for(be(),a=n.length;a<t.length;a+=1)r(a);ye()}},i(s){if(!o){for(let i=0;i<n.length;i+=1)y(t[i]);o=!0}},o(s){t=t.filter(Boolean);for(let i=0;i<t.length;i+=1)B(t[i]);o=!1},d(s){s&&m(e),ue(t,s)}}}function Le(l){let e,o,n;return o=new me({props:{class:"flex flex-1 flex-wrap gap-4 gap-y-6",group:{name:"toolbox",pull:"clone",put:!1},animation:150,sort:!1,onClone:l[1],$$slots:{default:[Ie]},$$scope:{ctx:l}}}),{c(){e=v("div"),k(o.$$.fragment),this.h()},l(t){e=w(t,"DIV",{id:!0});var r=C(e);E(o.$$.fragment,r),r.forEach(m),this.h()},h(){$(e,"id","toolbox")},m(t,r){b(t,e,r),N(o,e,null),n=!0},p(t,[r]){const s={};r&64&&(s.$$scope={dirty:r,ctx:t}),o.$set(s)},i(t){n||(y(o.$$.fragment,t),n=!0)},o(t){B(o.$$.fragment,t),n=!1},d(t){t&&m(e),O(o)}}}function Te(l){return[[{icon:"mdi:format-text",name:"TextBox"},{icon:"mdi:image",name:"ImageBox"},{icon:"mdi:card-text",name:"CardBox"},{icon:"mdi:code",name:"CodeBlock"},{icon:"mdi:table-row-plus-after",name:"Add Row"},{icon:"mdi:table-column-plus-after",name:"Add Col"}],n=>{n.item.id="clone-"+Date.now().toString()}]}class ke extends V{constructor(e){super(),R(this,e,Te,Le,J,{})}}function Ee(l){let e,o,n;return o=new G({props:{layoutConfig:l[2],components:he,debug:!0}}),{c(){e=v("div"),k(o.$$.fragment),this.h()},l(t){e=w(t,"DIV",{class:!0,id:!0,"data-id":!0});var r=C(e);E(o.$$.fragment,r),r.forEach(m),this.h()},h(){$(e,"class","flexilte-row"),$(e,"id","builder"),$(e,"data-id",l[1])},m(t,r){b(t,e,r),N(o,e,null),l[4](e),n=!0},p(t,[r]){const s={};r&4&&(s.layoutConfig=t[2]),o.$set(s),(!n||r&2)&&$(e,"data-id",t[1])},i(t){n||(y(o.$$.fragment,t),n=!0)},o(t){B(o.$$.fragment,t),n=!1},d(t){t&&m(e),O(o),l[4](null)}}}function Ne(l,e,o){let n,t;U(l,F,u=>o(5,n=u)),U(l,T,u=>o(2,t=u));let r,s=0;const i=()=>{const u=g(r);console.log("newConfig",u),setTimeout(()=>{T.set({...u}),o(1,s+=1)},100)},a=u=>{console.log("onAdd",u.item),i(),u.item.remove(),x(r)},p=u=>{console.log("onChoose",u.item),u.item.id?W.set(u.item.id):u.item.children[0].id&&W.set(u.item.children[0].id)},x=u=>{u.classList.contains("flexilte-col")||u.classList.contains("flexilte-row")?(ge.create(u,{group:{name:"toolbox"},animation:150,invertSwap:!0,fallbackOnBody:!0,invertedSwapThreshold:1,onAdd:a,onChoose:p}),Array.from(u.children).forEach(c=>{x(c)})):u.classList.contains("flexilte-row")&&Array.from(u.children).forEach(c=>{x(c)})},f=(u,c)=>c.classList.contains("flexilte-row")?{cols:[{...u}]}:{rows:[{...u}]},d=u=>{const c=Date.now().toString(),_={id:c,component:u.innerText,posX:"middle",posY:"middle",props:{text:"123"}};return F.update(H=>(H[c]=_,H)),_},g=u=>{var ee,te,oe,ne;let c={};const _=Array.from(u.children),H=_.some(h=>h.classList.contains("flexilte-row")),xe=_.some(h=>h.classList.contains("flexilte-col")),X=_.findIndex(h=>h.classList.contains("flexilte-item")),j=_.findIndex(h=>h.id.startsWith("clone-")),I=j!==-1?d(_[j]):void 0;if(H)c.rows=[],c.rows=_.map(h=>g(h)).filter(h=>Object.keys(h).length>0),I&&((ee=c.rows)==null||ee.splice(j,0,I)),c={...c,layoutClass:"my-4",alignHeight:!0};else if(xe)c.cols=[],c.cols=_.map(h=>g(h)).filter(h=>Object.keys(h).length>0),I&&((te=c.cols)==null||te.splice(j,0,I)),c={...c,layoutClass:"mx-4",alignHeight:!0};else if(I)if(X!==-1){const h=n[_[X].id];h&&(c=h),c=f(c,u),c.cols&&c.cols.splice(j,0,I),c.rows&&c.rows.splice(j,0,I)}else console.log("woop1",c,u);else if(X!==-1){const h=_.filter(L=>L.classList.contains("flexilte-item"));if(h.length>1){const[L,...se]=h.map($e=>n[$e.id]);L&&(c=L),c=f(c,u),c.cols&&(c.cols=[...c.cols,...se]),c.rows&&(c.rows=[...c.rows,...se])}else{const L=n[_[X].id];L&&(c=L)}}else console.log("woop2",u);return((oe=c.rows)==null?void 0:oe.length)===0&&delete c.rows,((ne=c.cols)==null?void 0:ne.length)===0&&delete c.cols,c};pe(()=>{x(r),Z.subscribe(()=>{i()})});function A(u){K[u?"unshift":"push"](()=>{r=u,o(0,r)})}return[r,s,t,i,A]}class Oe extends V{constructor(e){super(),R(this,e,Ne,Ee,J,{reRender:3})}get reRender(){return this.$$.ctx[3]}}function ae(l,e,o){const n=l.slice();return n[4]=e[o],n}function ce(l){let e,o,n=l[4].name+"",t,r,s,i,a,p,x;function f(...d){return l[2](l[4],...d)}return{c(){e=v("label"),o=v("span"),t=_e(n),r=P(),s=v("input"),a=P(),this.h()},l(d){e=w(d,"LABEL",{class:!0});var g=C(e);o=w(g,"SPAN",{});var A=C(o);t=ve(A,n),A.forEach(m),r=M(g),s=w(g,"INPUT",{class:!0,type:!0,placeholder:!0}),a=M(g),g.forEach(m),this.h()},h(){$(s,"class","input"),$(s,"type","text"),$(s,"placeholder","Input"),s.value=i=l[4].value,$(e,"class","label")},m(d,g){b(d,e,g),S(e,o),S(o,t),S(e,r),S(e,s),S(e,a),p||(x=Q(s,"change",f),p=!0)},p(d,g){l=d,g&2&&n!==(n=l[4].name+"")&&we(t,n),g&2&&i!==(i=l[4].value)&&s.value!==i&&(s.value=i)},d(d){d&&m(e),p=!1,x()}}}function Je(l){let e,o=q(l[1]),n=[];for(let t=0;t<o.length;t+=1)n[t]=ce(ae(l,o,t));return{c(){e=v("div");for(let t=0;t<n.length;t+=1)n[t].c();this.h()},l(t){e=w(t,"DIV",{class:!0});var r=C(e);for(let s=0;s<n.length;s+=1)n[s].l(r);r.forEach(m),this.h()},h(){$(e,"class","form-group")},m(t,r){b(t,e,r);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(e,null)},p(t,[r]){if(r&3){o=q(t[1]);let s;for(s=0;s<o.length;s+=1){const i=ae(t,o,s);n[s]?n[s].p(i,r):(n[s]=ce(i),n[s].c(),n[s].m(e,null))}for(;s<n.length;s+=1)n[s].d(1);n.length=o.length}},i:D,o:D,d(t){t&&m(e),ue(n,t)}}}function Ve(l,e,o){let n;U(l,F,i=>o(3,n=i));let t,r=[];return W.subscribe(i=>{n[i]&&(o(0,t=n[i]),console.log("here",t),o(1,r=Object.keys(t.props).map(a=>({name:a,value:t.props[a]}))))}),[t,r,(i,a)=>{console.log(a),F.update(p=>(p[t.id].props[i.name]=a.target.value,{...p})),Z.update(p=>!p)}]}class Re extends V{constructor(e){super(),R(this,e,Ve,Je,J,{})}}function je(l){let e,o="Export",n,t;return{c(){e=v("button"),e.textContent=o,this.h()},l(r){e=w(r,"BUTTON",{class:!0,"data-svelte-h":!0}),de(e)!=="svelte-1uep9i1"&&(e.textContent=o),this.h()},h(){$(e,"class","btn variant-filled")},m(r,s){b(r,e,s),n||(t=Q(e,"click",l[0]),n=!0)},p:D,i:D,o:D,d(r){r&&m(e),n=!1,t()}}}function Pe(l,e,o){let n;return U(l,T,r=>o(1,n=r)),[()=>{console.log(n),navigator.clipboard.writeText(JSON.stringify(n,null,2)).then(()=>{alert("Copied to your clipboard! Also in the console")})}]}class Me extends V{constructor(e){super(),R(this,e,Pe,je,J,{})}}function Ue(l){let e,o,n,t,r,s;return o=new me({props:{class:"flex flex-1 flex-wrap gap-4 gap-y-6 absolute inset-0",group:{name:"toolbox",pull:!1},animation:150,onAdd:l[1]}}),r=new Ae({props:{class:"h-12 w-12 text-slate-300",icon:"mdi:trash-outline"}}),{c(){e=v("div"),k(o.$$.fragment),n=P(),t=v("div"),k(r.$$.fragment),this.h()},l(i){e=w(i,"DIV",{class:!0});var a=C(e);E(o.$$.fragment,a),n=M(a),t=w(a,"DIV",{class:!0});var p=C(t);E(r.$$.fragment,p),p.forEach(m),a.forEach(m),this.h()},h(){$(t,"class","h-32 w-full bg-slate-400 border-2 border-slate-600 flex items-center justify-center absolute inset-0 z-10 opacity-75"),$(e,"class","relative h-32 w-full")},m(i,a){b(i,e,a),N(o,e,null),S(e,n),S(e,t),N(r,t,null),l[2](e),s=!0},p:D,i(i){s||(y(o.$$.fragment,i),y(r.$$.fragment,i),s=!0)},o(i){B(o.$$.fragment,i),B(r.$$.fragment,i),s=!1},d(i){i&&m(e),O(o),O(r),l[2](null)}}}function He(l,e,o){let n;const t=s=>{try{s.item.remove()}catch(i){console.error(i)}Z.update(i=>!i)};function r(s){K[s?"unshift":"push"](()=>{n=s,o(0,n)})}return[n,t,r]}class Xe extends V{constructor(e){super(),R(this,e,He,Ue,J,{})}}const fe={TextBox:{text:"Change me"},CodeBlock:{language:"ts",code:"// Change me"},ImageBox:{url:"https://placedog.net/200/200"},CardBox:{title:"Change me"}};function qe(l){let e,o,n,t,r="init",s,i,a;return o=new G({props:{layoutConfig:l[1],components:he}}),{c(){e=v("div"),k(o.$$.fragment),n=P(),t=v("button"),t.textContent=r,this.h()},l(p){e=w(p,"DIV",{id:!0,class:!0});var x=C(e);E(o.$$.fragment,x),x.forEach(m),n=M(p),t=w(p,"BUTTON",{"data-svelte-h":!0}),de(t)!=="svelte-16ut5ff"&&(t.textContent=r),this.h()},h(){$(e,"id","preview"),$(e,"class","flexilte-row")},m(p,x){b(p,e,x),N(o,e,null),l[3](e),b(p,n,x),b(p,t,x),s=!0,i||(a=Q(t,"click",l[4]),i=!0)},p(p,[x]){const f={};x&2&&(f.layoutConfig=p[1]),o.$set(f)},i(p){s||(y(o.$$.fragment,p),s=!0)},o(p){B(o.$$.fragment,p),s=!1},d(p){p&&(m(e),m(n),m(t)),O(o),l[3](null),i=!1,a()}}}function Y(l){var o,n;let e={};if(l){if((o=l.classList)!=null&&o.contains("flexilte-row")){console.log(1,l);const t=Array.from(l.children).map(Y).filter(r=>r!==void 0);t.length>0&&(e.rows=t)}else if((n=l.classList)!=null&&n.contains("flexilte-col")){console.log(2,l);const t=Array.from(l.children).map(Y).filter(r=>r!==void 0);t.length>0&&(e.cols=t)}else if(l.id.startsWith("clone-"))console.log(3,l,l.id),e.component=l==null?void 0:l.innerText,e.props={};else{console.log(4,l);return}if(console.log(5,e),!(!e.rows&&!e.cols&&!e.component))return e}}function z(l,e){if(Array.isArray(l)&&Array.isArray(e))return l.map((o,n)=>n<e.length?z(o,e[n]):o).concat(e.slice(l.length));if(l instanceof Object&&e instanceof Object){for(const o in e)e[o]instanceof Object&&o in l?l[o]=z(l[o],e[o]):l[o]=e[o];return l}else return e}function Fe(l,e,o){let n;U(l,T,f=>o(1,n=f));let t;function r(f){if(f&&typeof f=="object")for(const d in f)f[d]&&typeof f[d]=="object"&&(f[d].component&&fe[f[d].component]&&(f[d].props=fe[f[d].component]),r(f[d]))}const s=f=>{console.log("add",f.item),f.item.innerText,T.update(d=>{var A;const g=Y(t.children[0]);return g&&(console.log("parsed",JSON.parse(JSON.stringify(g))),console.log("b4",JSON.parse(JSON.stringify(d))),((A=d.rows)==null?void 0:A.length)===1&&d.rows[0].component==="AddBox"?d=g:d=z(d,g),console.log("after",JSON.parse(JSON.stringify(d)))),r(d),a(t),d})},i=f=>{console.log("onRemove",f.item)};T.subscribe(f=>console.log("config",f));const a=f=>{console.log("ee",f),(f.classList.contains("flexilte-row")||f.classList.contains("flexilte-col"))&&(ge.create(f,{group:{name:"toolbox"},animation:150,onAdd:s,onRemove:i}),Array.from(f.children).forEach(d=>{a(d)}))};pe(()=>{console.log("init..."),T.update(f=>(console.log("inited layout",f),{...f}))});function p(f){K[f?"unshift":"push"](()=>{t=f,o(0,t)})}return[t,n,a,p,()=>a(t)]}class We extends V{constructor(e){super(),R(this,e,Fe,qe,J,{})}}function Ye(l){let e,o,n;return o=new G({props:{layoutConfig:l[1],components:l[0]}}),{c(){e=v("div"),k(o.$$.fragment),this.h()},l(t){e=w(t,"DIV",{class:!0});var r=C(e);E(o.$$.fragment,r),r.forEach(m),this.h()},h(){$(e,"class","container mx-auto mt-6")},m(t,r){b(t,e,r),N(o,e,null),n=!0},p:D,i(t){n||(y(o.$$.fragment,t),n=!0)},o(t){B(o.$$.fragment,t),n=!1},d(t){t&&m(e),O(o)}}}function ze(l){return[{ExportButton:Me,TextBox:De,DNDList:ke,DNDBuilder:Oe,Inspector:Re,ImageBox:Ce,RemoveBox:Xe,DNDPreview:We,AddBox:Be},{rows:[{component:"TextBox",props:{type:"h2",text:"Flexilte Drag And Drop Editor"},posX:"middle"},{cols:[{component:"ExportButton",props:{text:"Export"},posX:"right",posY:"middle"}]},{layoutClass:"mt-4",cols:[{width:"md:w-2/6",layoutClass:"variant-ghost p-4",rows:[{component:"TextBox",props:{type:"h4",text:"UI Components"}},{component:"DNDList",nodeClass:"flex-1"},{component:"RemoveBox"}]},{width:"md:w-5/6",layoutClass:"variant-ghost p-4",rows:[{component:"TextBox",props:{type:"h4",text:"Preview"}},{component:"DNDBuilder",nodeClass:"flex-1"}]},{width:"md:w-1/6",layoutClass:"variant-ghost p-4",rows:[{component:"TextBox",props:{type:"h4",text:"Inspector"}},{component:"Inspector",nodeClass:"flex-1"}]}]}]}]}class nt extends V{constructor(e){super(),R(this,e,ze,Ye,J,{})}}export{nt as component};
